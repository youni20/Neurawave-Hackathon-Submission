<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dr. Neura - Symptom Triggers</title>
    <script src="[https://unpkg.com/lucide@latest](https://unpkg.com/lucide@latest)"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: #0f172a;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        h1 { font-size: 2rem; margin-bottom: 10px; color: #0f172a; font-weight: 700; }
        p.subtitle { color: #64748b; margin-bottom: 30px; }

        .weather-card {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(37, 99, 235, 0.3);
            display: none; /* Hidden initially */
            animation: slideUp 0.4s ease-out;
        }

        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .temp-display { font-size: 3.5rem; font-weight: 800; margin: 10px 0; }
        .location-display { font-size: 1.2rem; opacity: 0.9; }
        .coordinates { font-size: 0.8rem; opacity: 0.6; margin-top: 5px; }

        .input-group { display: flex; gap: 10px; margin-bottom: 10px; }
        
        input {
            flex: 1; padding: 14px; border: 2px solid #e2e8f0; border-radius: 10px;
            font-size: 1rem; outline: none; transition: border 0.3s ease;
        }
        input:focus { border-color: #3b82f6; }

        button {
            padding: 14px 24px; background: #0f172a; color: white; border: none;
            border-radius: 10px; font-size: 1rem; font-weight: 600; cursor: pointer;
            display: flex; align-items: center; gap: 8px; transition: all 0.3s ease;
        }
        button:hover { background: #1e293b; transform: translateY(-2px); }
        
        .back-link {
            display: inline-block; margin-top: 20px; color: #64748b; text-decoration: none; font-size: 0.9rem;
        }
        .back-link:hover { color: #0f172a; }

        .error-msg { color: #ef4444; margin-top: 10px; font-size: 0.9rem; display: none; }
        
        /* Loading Spinner */
        .loader {
            width: 20px; height: 20px; border: 3px solid #ffffff; 
            border-bottom-color: transparent; border-radius: 50%; 
            display: none; animation: rotation 1s linear infinite;
        }
        @keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    </style>
</head>
<body>

    <div class="container">
        <div style="display: flex; justify-content: center; margin-bottom: 15px; color: #3b82f6;">
            <i data-lucide="cloud-sun" size="48"></i>
        </div>
        
        <h1>Check Triggers</h1>
        <p class="subtitle">Monitor local temperature changes that might trigger a migraine.</p>

        <!-- Weather Display Card -->
        <div id="weatherCard" class="weather-card">
            <div class="location-display" id="locationText">--</div>
            <div class="temp-display" id="tempText">--°C</div>
            <div class="coordinates" id="coordText">Lat: --, Lon: --</div>
        </div>

        <!-- Input Section -->
        <div class="input-group">
            <input type="text" id="cityInput" placeholder="Enter city (e.g. Kalmar)" autocomplete="off" />
            <button id="searchBtn">
                <span id="btnText">Check</span>
                <div id="loader" class="loader"></div>
            </button>
        </div>
        <div id="errorMsg" class="error-msg">Could not find city. Try again.</div>

        <a href="index.html" class="back-link">← Back to Dr. Neura</a>
    </div>

    <script>
        lucide.createIcons();
        
        // --- CONFIGURATION ---
        // Make sure this matches your server IP
        const SERVER_URL = '[http://100.89.109.97:5000/weather](http://100.89.109.97:5000/weather)'; 

        const el = {
            input: document.getElementById('cityInput'),
            btn: document.getElementById('searchBtn'),
            card: document.getElementById('weatherCard'),
            loc: document.getElementById('locationText'),
            temp: document.getElementById('tempText'),
            coord: document.getElementById('coordText'),
            err: document.getElementById('errorMsg'),
            loader: document.getElementById('loader'),
            btnText: document.getElementById('btnText')
        };

        async function getWeather() {
            const city = el.input.value.trim();
            if (!city) return;

            // UI Loading State
            el.btn.disabled = true;
            el.btnText.style.display = 'none';
            el.loader.style.display = 'block';
            el.err.style.display = 'none';
            el.card.style.display = 'none';

            try {
                const res = await fetch(SERVER_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ city: city })
                });

                if (!res.ok) throw new Error('City not found');

                const data = await res.json();

                // Update UI with Data
                el.loc.textContent = `${data.city}, ${data.country}`;
                el.temp.textContent = `${data.temperature}°C`;
                el.coord.textContent = `Lat: ${data.lat.toFixed(2)}, Lon: ${data.lon.toFixed(2)}`;
                
                el.card.style.display = 'block'; // Show card with animation

            } catch (error) {
                console.error(error);
                el.err.style.display = 'block';
            } finally {
                // Reset Button
                el.btn.disabled = false;
                el.btnText.style.display = 'block';
                el.loader.style.display = 'none';
                el.input.value = '';
                el.input.focus();
            }
        }

        el.btn.addEventListener('click', getWeather);
        el.input.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') getWeather();
        });
    </script>
</body>
</html>